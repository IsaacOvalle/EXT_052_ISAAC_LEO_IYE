<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BRAZUK - Ver Video</title>

  <!-- √çconos de Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      background-color: #ffffff;
      overflow-x: hidden;
    }

    header {
      background-color: #f4c52b;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 20px;
      height: 60px;
      border-bottom: 2px solid #ccc;
      position: sticky;
      top: 0;
      z-index: 3;
    }

    .logo-container {
      display: flex;
      align-items: center;
      gap: 8px; /* espacio entre men√∫ y logo */
    }

    .logo {
      font-weight: bold;
      font-size: 22px;
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }

.menu-icon {
    color: #000; /* color normal */
    transition: color 0.2s ease;
    font-size: 22px;
    cursor: pointer;
}

.menu-icon.oscuro {
    color: #fff !important; /* color en modo oscuro */
   font-size: 22px;
   cursor: pointer;
}


    .search-bar {
      display: flex;
      align-items: center;
      background-color: #dfffb2;
      border-radius: 25px;
      padding: 5px 15px;
      width: 40%;
    }

    .search-bar input {
      border: none;
      outline: none;
      background: transparent;
      width: 100%;
      padding: 5px;
      font-size: 16px;
    }

    .search-bar button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 18px;
    }

    .profile-icon {
      border: 2px solid #000;
      border-radius: 50%;
      padding: 6px;
      cursor: pointer;
    }

    .user-info {
  display: flex;
  align-items: center;
  gap: 8px; /* espacio entre nombre y foto */
  font-weight: 600;
  font-size: 16px;
  color: #000; /* color por defecto, cambiar√° con JS para modo oscuro */
}

.profile-icon{
  border:2px solid #000;
  border-radius:50%;
  padding:6px;    
  cursor:pointer;
  width:50px;        
  height:50px;      
  background-size: cover;
  background-position: center;
}

    /* Men√∫s laterales */
    .menu-lateral {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      transform: translateX(-100%);
      background: #f4c52b;
      box-shadow: 3px 0 14px rgba(0, 0, 0, 0.15);
      padding-top: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      z-index: 4;
      transition: transform 0.32s ease;
      min-width: 180px;
    }

    .menu-lateral.abierto {
      transform: translateX(0);
    }

    .menu-derecha {
      position: fixed;
      top: 0;
      right: 0;
      left: auto;
      height: 100vh;
      transform: translateX(100%);
      background: #f4c52b;
      box-shadow: -3px 0 14px rgba(0, 0, 0, 0.15);
      padding-top: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      z-index: 4;
      transition: transform 0.32s ease;
      min-width: 180px;
    }

    .menu-derecha.abierto {
      transform: translateX(0);
    }

    .menu-lateral button,
    .menu-derecha button {
      width: 80%;
      background: #baf46a;
      border: none;
      border-radius: 20px;
      padding: 10px 12px;
      font-weight: 600;
      cursor: pointer;
    }

    .menu-lateral button:hover,
    .menu-derecha button:hover {
      background: #a4e45a;
    }

    /* Contenido principal */
    #pageContent {
      transition: transform 0.32s ease;
      will-change: transform;
    }

    main {
      display: flex;
      justify-content: space-between;
      width: 90%;
      margin: 20px auto;
      gap: 20px;
    }

    /* Video principal */
    .main-video {
      flex: 2.5;
      background-color: #baf46a;
      border-radius: 20px;
      padding: 15px;
    }

    iframe {
      width: 100%;
      height: 400px;
      border-radius: 15px;
      background-color: #e6e6e6;
    }

    .video-info {
      margin-top: 10px;
      padding: 10px;
    }

    .video-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .video-header h2 {
      font-size: 20px;
      color: #000;
      margin-bottom: 5px;
    }

    .video-actions {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .video-actions button {
      background-color: #dfffb2;
      border: none;
      border-radius: 20px;
      padding: 5px 12px;
      cursor: pointer;
      transition: 0.2s;
      font-size: 14px;
    }

    .video-actions button:hover {
      background-color: #a4e45a;
    }

    .video-actions button.active {
      background-color: #f4c52b;
      color: #000;
      border: 2px solid #f4c52b;
    }

    .video-actions button.active i {
      color: #000;
    }

    .video-info p {
      font-size: 14px;
      color: #333;
      margin-top: 5px;
    }

    /* Comentarios */
    .comments {
      margin-top: 20px;
      background-color: #dfffb2;
      border-radius: 10px;
      padding: 10px;
    }

    .comments h3 {
      font-size: 16px;
      margin-bottom: 8px;
    }

    .comment {
      background-color: #fff;
      border-radius: 8px;
      padding: 8px;
      margin-bottom: 8px;
    }

    /* Videos relacionados */
    .related-videos {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .related-video img {
      width: 100%;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .related-video img:hover {
      transform: scale(1.05);
    }

    .aviso-logo {
  position: fixed;
  top: 10px;
  right: 10px;
  background: rgba(255, 255, 0, 0.9);
  padding: 8px 12px;
  border-radius: 6px;
  box-shadow: 0 0 6px rgba(0,0,0,0.3);
  font-size: 14px;
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 8px;
  color: #000; 
  font-weight: bold; 
}

.aviso-logo button.cerrar-aviso {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  padding: 0;
  margin: 0;
  color: #000; 
}

    /* Responsive */
    @media (max-width: 900px) {
      main {
        flex-direction: column;
      }

      .related-videos {
        flex-direction: row;
        overflow-x: auto;
      }
    }

    @media (max-width: 767px){

     header {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-between;
    height: auto;
    padding: 10px;
    gap: 10px;
  }

  .search-bar {
    order: 2;
    width: 100%;
    margin-top: 5px;
  }

  .user-info {
    order: 1;
    /*flex-direction: column;
    align-items: left;*/
    gap: 6px;
  }

  main {
    width: 95%;
    padding: 10px;
  }

}

    
  </style>
</head>

<body>
<div id="pageContent">
  <header>
    <div class="logo-container">
      <span class="menu-icon" id="menuIcon">‚ò∞</span>
      <a href="Segundo avance_Pagina Principal.html" class="logo">BRAZUK</a>
    </div>

    <div class="search-bar">
      <input type="text" placeholder="Buscar..." />
      <button>üîç</button>
    </div>

  <!-- Contenedor del nombre y perfil -->
  <div class="user-info">
    <span id="nombreUsuario"></span>
    <div class="profile-icon" id="profileIcon">üë§</div>
  </div>
  </header>

  <main>
      <h2><span id="nombreUsuario"></span></h2>

    <section class="main-video">
<iframe
    src="https://www.youtube.com/embed/dQw4w9WgXcQ"
    title="Video de YouTube"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    id="videoFrame"
    class="video-principal"
>
</iframe>


      <div class="video-info">
        <div class="video-header">
          <h2 id="videoTitle">T√≠tulo del video</h2>
          <div class="video-actions">
            <button id="likeBtn"><i class="fa-solid fa-thumbs-up"></i> Me gusta</button>
            <button id="saveBtn"><i class="fa-solid fa-bookmark"></i> Guardar</button>
          </div>
        </div>

        <p id="videoAuthor">Autor del video</p>

        <div class="comments" id="commentsContainer">
          <h3>Comentarios</h3>
        </div>
      </div>
    </section>
    <aside class="related-videos">
      <div class="related-video" data-id="video1" data-link="https://www.youtube.com/embed/8wTyv-5E5Kc" data-title="Germany - Argentina World Cup 2014 final | Highlights | 4K UHD 60 fps" data-author="Autor 1">
        <img src="https://img.youtube.com/vi/8wTyv-5E5Kc/maxresdefault.jpg" alt="Mundial 2018" />
      </div>
      <div class="related-video" data-id="video2" data-link="https://www.youtube.com/embed/hMl5Ni7s6uc?si=Q9dbIVQ1smGClOsV" data-title="Neymar acting & rolling || neymar funniest moments || Worldcup Brazil" data-author="Autor 2">
        <img src="https://img.youtube.com/vi/hMl5Ni7s6uc/maxresdefault.jpg" alt="Mundial 2014" />
      </div>
      <div class="related-video" data-id="video3" data-link="https://www.youtube.com/embed/RAt-fzSVamY?si=JPa-5FTkk0Cigjr4" data-title="Todos los CAMPEONES y FINALES de los MUNDIALES (1930-2022)" data-author="Autor 3">
        <img src="https://img.youtube.com/vi/RAt-fzSVamY/maxresdefault.jpg" alt="Mundial 2010" />
      </div>
      <div class="related-video" data-id="video4" data-link="https://www.youtube.com/embed/NTzefzfCH0M?si=HlQuEGpvGxqK66ZH" data-title="MASCOTAS DEL MUNDIAL: Una retrospectiva" data-author="Autor 4">
        <img src="https://img.youtube.com/vi/NTzefzfCH0M/maxresdefault.jpg" alt="Mundial 2006" />
      </div>
      <div class="related-video" data-id="video5" data-link="https://www.youtube.com/embed/WvzmlLuX8AQ?si=Tp-2su5KliBL0Ncy" data-title="Las CANCIONES de Todos los MUNDIALES DE F√öTBOL (1930-2022)" data-author="Autor 5">
        <img src="https://img.youtube.com/vi/WvzmlLuX8AQ/maxresdefault.jpg" alt="Mundial 2002" />
      </div>
    </aside>
  </main>
</div>

<div class="menu-lateral" id="menuLateral">
  <button onclick="location.href='Segundo avance_Ver historial.html'">Historial</button>
  <button onclick="location.href='Segundo avance_Ver guardados.html'">Guardados</button>
  <button onclick="location.href='Segundo avance_Ver me gustas.html'">Me gusta</button>
</div>

<div class="menu-lateral menu-derecha" id="menuPerfil">
  <button onclick="location.href='Cuenta.html'">Cuenta</button>
  <button onclick="location.href='Segundo avance_Usuario.html'">Ver mi foro</button>

  <!-- Botones que se ocultar√°n si NO eres admin -->
  <button id="btnSolicitudes" onclick="location.href='Segundo avance_Solicitudes.html'">Solicitudes</button>
  <button id="btnBaneados" onclick="location.href='Segundo avance_Baneados.html'">Baneados</button>
  <button id="btnDadasBaja" onclick="location.href='Segundo Avance_Publicaciones baneadas.html'">Dadas de baja</button>

  <button id="toggleAspecto">Aspecto: Cla/Osc</button>
  <button onclick="location.href='BrazukaR.html'">Salir</button>
</div>


<script>
const likeBtn = document.getElementById('likeBtn');
const saveBtn = document.getElementById('saveBtn');
const mainVideo = document.querySelector('.main-video iframe');
const videoTitle = document.getElementById('videoTitle');
const videoAuthor = document.getElementById('videoAuthor');
const commentsContainer = document.getElementById('commentsContainer');
const relatedVideos = document.querySelectorAll('.related-video');

const menuLateral = document.getElementById('menuLateral');
const menuPerfil = document.getElementById('menuPerfil');
const pageContent = document.getElementById('pageContent');
const menuIcon = document.getElementById('menuIcon');
const profileIcon = document.getElementById('profileIcon');

// FOTO DE PERFIL SEG√öN EL ROL
const rol = localStorage.getItem("rolUsuario");

const fotoUsuario = document.getElementById("fotoUsuario");

const fotos = {
  admin: "https://static.vecteezy.com/system/resources/previews/014/541/527/original/administrator-system-icon-simple-style-vector.jpg",
  usuario: "https://i0.wp.com/icon-library.com/images/user-icon-png-transparent/user-icon-png-transparent-17.jpg",
  invitado: "https://static.vecteezy.com/system/resources/previews/008/302/462/large_2x/eps10-grey-user-icon-or-logo-in-simple-flat-trendy-modern-style-isolated-on-white-background-free-vector.jpg"
};


// --- √çCONO DE LA ESQUINA ---
if (rol === "admin") {
  profileIcon.textContent = ""; 
  profileIcon.style.backgroundImage = `url('${fotos.admin}')`;
}
else if (rol === "usuario") {
  profileIcon.textContent = "";
  profileIcon.style.backgroundImage = `url('${fotos.usuario}')`;
}
else if (rol === "invitado") {
  profileIcon.textContent = "";
  profileIcon.style.backgroundImage = `url('${fotos.invitado}')`;
}

profileIcon.style.backgroundSize = "cover";
profileIcon.style.backgroundPosition = "center";

// Ocultar botones seg√∫n el rol
if (rol !== "admin") {
  document.getElementById("btnSolicitudes").style.display = "none";
  document.getElementById("btnBaneados").style.display = "none";
  document.getElementById("btnDadasBaja").style.display = "none";
}

// ====== Funci√≥n para capturar miniatura desde un video principal ======
function captureThumbnail(video) {
  // Como en tu c√≥digo actual est√°s usando <iframe> para YouTube
  let src = video.getAttribute("src") || "";
  let videoIdMatch = src.match(/embed\/([a-zA-Z0-9_-]+)/);
  let videoId = videoIdMatch ? videoIdMatch[1] : null;
  if(videoId){
    return `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
  }
  return 'https://via.placeholder.com/200x130';
}


// Funci√≥n para obtener par√°metros de la URL
function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}

let selectedVideoId = getQueryParam("video") || "video1"; 

const defaultVideoStates = {
  video1: { liked:false, saved:false, comments:["Buen video üëè","¬°Excelente contenido!"] },
  video2: { liked:false, saved:false, comments:["Video divertido üòÑ","Muy bueno"] },
  video3: { liked:false, saved:false, comments:["Terror√≠fico üò±","Me asust√©"] },
  video4: { liked:false, saved:false, comments:["Rap incre√≠ble üéµ","Me encant√≥"] },
  video5: { liked:false, saved:false, comments:["Partido emocionante ‚öΩ","Gran jugada"] },
};

let videoStates = JSON.parse(localStorage.getItem("videoStates")) || defaultVideoStates;
let currentVideoId = selectedVideoId;

function saveState() {
  localStorage.setItem("videoStates", JSON.stringify(videoStates));
}

function loadVideo(videoId, link, title, author){
  currentVideoId = videoId;
  mainVideo.src = link;
  videoTitle.textContent = title;
  videoAuthor.textContent = author;

  commentsContainer.innerHTML = "<h3>Comentarios</h3>";
  videoStates[videoId].comments.forEach(c=>{
    const div = document.createElement("div");
    div.className = "comment";
    div.textContent = c;
    commentsContainer.appendChild(div);
  });

  likeBtn.classList.toggle("active", videoStates[videoId].liked);
  saveBtn.classList.toggle("active", videoStates[videoId].saved);
}

likeBtn.onclick = () => {
  likeBtn.classList.toggle("active");
  const liked = likeBtn.classList.contains("active");

  const id = currentVideoId;
  localStorage.setItem(`like_video_${id}`, liked);

  // Obtener miniatura del video desde el iframe
  const videoElem = document.querySelector('.main-video iframe');
  const thumbnailSrc = videoElem ? captureThumbnail(videoElem) : 'https://via.placeholder.com/200x130';

  if (liked) {
    // Guardar los datos completos del post
    const post = {
      id: id,
      url: window.location.href,
      thumbnail: thumbnailSrc,
      titulo: videoTitle.textContent || 'T√≠tulo del video',
      autor: videoAuthor.textContent || 'Autor',
      tipo: 'video',
      timestamp: Date.now()
    };
    localStorage.setItem(`post_video_${id}`, JSON.stringify(post));
  } else {
    // Si se quita el like, no lo mostramos en "Ver Me gusta"
    localStorage.removeItem(`post_video_${id}`);
  }

  // Actualizar estado interno
  videoStates[id].liked = liked;
  saveState();
};


saveBtn.onclick = () => {
  const state = videoStates[currentVideoId];
  state.saved = !state.saved;
  saveBtn.classList.toggle("active", state.saved);
  saveState();

// Obtener miniatura correctamente desde el iframe principal
const videoElem = document.querySelector('.main-video iframe');
const thumbnailSrc = videoElem ? captureThumbnail(videoElem) : 'https://via.placeholder.com/200x130';


  const post = {
    id: currentVideoId,
    url: window.location.href,
    thumbnail: thumbnailSrc,
    titulo: document.querySelector('#videoTitle')?.innerText || 'T√≠tulo del video',
    autor: document.querySelector('#videoAuthor')?.innerText || 'Autor',
    tipo: 'video',
    timestamp: Date.now()   
  };

  if(state.saved){
    localStorage.setItem(`post_video_${currentVideoId}`, JSON.stringify(post));
  } else {
    localStorage.removeItem(`post_video_${currentVideoId}`);
  }
};


// Men√∫ hamburguesa izquierda
menuIcon.onclick = (e)=>{
  e.stopPropagation();
  menuLateral.classList.toggle('abierto');
  if(menuPerfil.classList.contains('abierto')) menuPerfil.classList.remove('abierto');
  pageContent.style.transform = menuLateral.classList.contains('abierto') ? "translateX(180px)" : "translateX(0)";
};

// Men√∫ perfil derecha
profileIcon.onclick = (e)=>{
  e.stopPropagation();
  menuPerfil.classList.toggle('abierto');
  if(menuLateral.classList.contains('abierto')) menuLateral.classList.remove('abierto');
  pageContent.style.transform = menuPerfil.classList.contains('abierto') ? "translateX(-180px)" : "translateX(0)";
};

// Cerrar men√∫s al hacer clic fuera
document.addEventListener('click', (e)=>{
  if(!menuLateral.contains(e.target) && !menuIcon.contains(e.target) && menuLateral.classList.contains('abierto')){
    menuLateral.classList.remove('abierto');
    pageContent.style.transform = "translateX(0)";
  }
  if(!menuPerfil.contains(e.target) && !profileIcon.contains(e.target) && menuPerfil.classList.contains('abierto')){
    menuPerfil.classList.remove('abierto');
    pageContent.style.transform = "translateX(0)";
  }
});

// Click en videos relacionados
relatedVideos.forEach(video=>{
  video.addEventListener("click", ()=>{
    const id = video.dataset.id;
    const link = video.dataset.link;
    const title = video.dataset.title;
    const author = video.dataset.author;

    loadVideo(id, link, title, author);

    // Actualizar URL
    const newUrl = window.location.pathname + "?video=" + id;
    window.history.replaceState(null, "", newUrl);
    window.scrollTo({top:0, behavior:"smooth"});

    // ====== Guardar en historial al hacer clic ======
    const imgElement = video.querySelector("img");
const thumbnailSrc = imgElement ? imgElement.getAttribute("src") : 'https://via.placeholder.com/200x130';

    const post = {
      url: window.location.href,
      thumbnail: thumbnailSrc,
      titulo: title,
      autor: author,
      tipo: 'video',
      id: id,
      timestamp: Date.now()
    };

    let historial = JSON.parse(localStorage.getItem('brazukHistorial') || '[]');

    const index = historial.findIndex(p => p.id === post.id);
    if(index >= 0){
      historial[index] = {...historial[index], timestamp: Date.now()};
      historial.unshift(historial.splice(index,1)[0]);
    } else {
      historial.unshift(post);
    }

    localStorage.setItem('brazukHistorial', JSON.stringify(historial));
  });
});


// Cargar video inicial
let selectedVideo = Array.from(relatedVideos).find(
  v => v.dataset.id === selectedVideoId
);

if (!selectedVideo) {
  selectedVideo = relatedVideos[0];
}


loadVideo(
  selectedVideo.dataset.id,
  selectedVideo.dataset.link,
  selectedVideo.dataset.title,
  selectedVideo.dataset.author
);
// ===== Modo claro/oscuro global para todas las p√°ginas =====
(function(){
  const menuPerfil = document.getElementById('menuPerfil');
  if(!menuPerfil) return;

  const btnModo = menuPerfil.querySelector('button:nth-child(6)');

function aplicarModo(modo){
    const body = document.body;
    const pageContent = document.getElementById('pageContent');
    const header = document.querySelector('header');
    const logo = document.querySelector('.logo');
    const menuIcon = document.querySelector('.menu-icon');
    const nombreUsuarioSpan = document.getElementById('nombreUsuario');

    if(modo === 'oscuro'){
        body.style.background = '#000';
        if(pageContent) pageContent.style.background = '#111';
        if(header) header.style.background = '#000';
        if(logo) logo.style.color = '#fff';
        if(menuIcon) menuIcon.style.color = '#fff';  
        nombreUsuarioSpan.style.color = '#fff'; 
    } else {
        body.style.background = '#fff';
        if(pageContent) pageContent.style.background = '#fff';
        if(header) header.style.background = '#f4c52b';
        if(logo) logo.style.color = '#000';
        if(menuIcon) menuIcon.style.color = '#000';  
        nombreUsuarioSpan.style.color = '#000'; 
    }
}

  // Aplicar modo guardado al cargar la p√°gina
  let modoGuardado = localStorage.getItem('modoBrazuk') || 'claro';
  aplicarModo(modoGuardado);

  // Cambiar modo al hacer clic
  btnModo.addEventListener('click', ()=>{
    modoGuardado = (modoGuardado==='claro') ? 'oscuro' : 'claro';
    localStorage.setItem('modoBrazuk', modoGuardado);
    aplicarModo(modoGuardado);
  });

})();


// ====== Guardar autom√°ticamente el video visitado ======
(function(){
  const params = new URLSearchParams(window.location.search);
  const id = params.get('video'); // aqu√≠ usamos el par√°metro de video
  if(!id) return;

  // Miniatura del video
  const relatedVideo = document.querySelector(`.related-video[data-id="${id}"] img`);
  const thumbnailSrc = relatedVideo?.src || 'https://via.placeholder.com/200x130';

  const post = {
    url: window.location.href,
    thumbnail: thumbnailSrc,
    titulo: document.querySelector('#videoTitle')?.innerText || 'T√≠tulo del video',
    autor: document.querySelector('#videoAuthor')?.innerText || 'Autor',
    tipo: 'video',
    id: id,
    timestamp: Date.now()
  };

  // Cargar historial existente
  let historial = JSON.parse(localStorage.getItem('brazukHistorial') || '[]');

  // Si ya existe, actualizar timestamp y mover al inicio
  const index = historial.findIndex(p => p.id === post.id);
  if(index >= 0){
    historial[index] = {...historial[index], timestamp: Date.now()};
    historial.unshift(historial.splice(index,1)[0]);
  } else {
    historial.unshift(post);
  }

  // Guardar en localStorage
  localStorage.setItem('brazukHistorial', JSON.stringify(historial));
})();

const nombre = localStorage.getItem("nombreUsuario") || "Invitado";
document.getElementById("nombreUsuario").textContent = `${nombre}`;

</script>

<div id="avisoLogo" class="aviso-logo">
  <span>Mira mas videos pulsando alguna miniatura de la derecha</span>
  <button class="cerrar-aviso">√ó</button>
</div>
<script>
  document.querySelector(".cerrar-aviso").addEventListener("click", function () {
    document.getElementById("avisoLogo").style.display = "none";
  });
</script>

</body>
</html>
