<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BRAZUK - Guardados</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial, sans-serif;}
body{background:#fff;overflow-x:hidden;}
header{
  background:#f4c52b;display:flex;align-items:center;justify-content:space-between;
  padding:0 20px;height:60px;border-bottom:2px solid #ccc;position:sticky;top:0;z-index:3;
}
.logo{display:flex;align-items:center;font-weight:bold;font-size:22px;cursor:pointer;line-height:1;padding-top:2px;}
.menu-icon{font-size:22px;margin-right:10px;cursor:pointer;}
.search-bar{display:flex;align-items:center;background:#dfffb2;border-radius:25px;padding:5px 15px;width:40%;}
.search-bar input{border:none;outline:none;background:transparent;width:100%;padding:5px;font-size:16px;}
.search-bar button{background:none;border:none;cursor:pointer;font-size:18px;}
.profile-icon{border:2px solid #000;border-radius:50%;padding:6px;cursor:pointer;}
.user-info {
  display: flex;
  align-items: center;
  gap: 8px; /* espacio entre nombre y foto */
  font-weight: 600;
  font-size: 16px;
  color: #000; /* color por defecto, cambiar√° con JS para modo oscuro */
}
.profile-icon{
  border:2px solid #000;
  border-radius:50%;
  padding:6px;      
  cursor:pointer;
  width:50px;       
  height:50px;      
  background-size: cover;
  background-position: center;
}

.menu-lateral, .menu-derecha{
  position:fixed;top:0;height:100vh;background:#f4c52b;
  box-shadow:3px 0 14px rgba(0,0,0,0.15);padding-top:80px;display:flex;flex-direction:column;align-items:center;gap:12px;
  z-index:4;transition:transform 0.32s ease;min-width:180px;
}
.menu-lateral{left:0;transform:translateX(-100%);}
.menu-lateral.abierto{transform:translateX(0);}
.menu-derecha{right:0;left:auto;transform:translateX(100%);}
.menu-derecha.abierto{transform:translateX(0);}
.menu-lateral button, .menu-derecha button{
  width:80%;background:#baf46a;border:none;border-radius:20px;padding:10px 12px;font-weight:600;cursor:pointer;
}
.menu-lateral button:hover, .menu-derecha button:hover{background:#a4e45a;}
#pageContent{transition:transform 0.32s ease;}
main{width:90%;margin:20px auto;}
h1{font-size:24px;margin-bottom:20px;color:#000;}
.historial-container{
  background:#baf46a;border-radius:20px;padding:20px;display:flex;flex-direction:column;gap:20px;
}
.post-item{
  background:#dfffb2;border-radius:12px;padding:10px;display:flex;align-items:center;gap:15px;
  cursor:default;
}
.thumbnail{
  width:200px;height:130px;background:#eaeaea;border-radius:10px;display:flex;justify-content:center;align-items:center;
  overflow:hidden;flex-shrink:0;cursor:pointer;position:relative;
}
.thumbnail img, .thumbnail video{width:100%;height:100%;object-fit:cover;}
.thumbnail .play-icon{
  position:absolute;color:white;font-size:40px;opacity:0.8;
}
.post-info{flex:1;display:flex;flex-direction:column;justify-content:space-between;}
.post-info h2{font-size:18px;cursor:pointer;}
.post-info p{font-size:14px;color:#333;}

.aviso-logo {
  position: fixed;
  top: 10px;
  right: 10px;
  background: rgba(255, 255, 0, 0.9);
  padding: 8px 12px;
  border-radius: 6px;
  box-shadow: 0 0 6px rgba(0,0,0,0.3);
  font-size: 14px;
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 8px;
  color: #000; 
  font-weight: bold; 
}

.aviso-logo button.cerrar-aviso {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  padding: 0;
  margin: 0;
  color: #000; 
}

@media (max-width: 900px){ .media-item{ width:45%; } }
@media (max-width: 520px){ .media-item{ width:90%; } }
@media (max-width: 767px) {
   header {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-between;
    height: auto;
    padding: 10px;
    gap: 10px;
  }

  .search-bar {
    order: 2;
    width: 100%;
    margin-top: 5px;
  }

  .user-info {
    order: 1;
    /*flex-direction: column;
    align-items: left;*/
    gap: 6px;
  }

  main {
    width: 95%;
    padding: 10px;
  }

  .historial-container {
    padding: 15px;
    gap: 15px;
  }

  .post-item {
    flex-direction: column;
    align-items: flex-start;
  }

  .thumbnail {
    width: 100%;
    height: auto;
    max-width: 300px;
  }

  .post-info {
    width: 100%;
    gap: 10px;
  }

  
}
</style>
</head>
<body>

<div id="pageContent">
<header>
  <div class="logo"><span class="menu-icon">‚ò∞</span> BRAZUK</div>
  <div class="search-bar">
    <input type="text" placeholder="Buscar..." />
    <button>üîç</button>
  </div>
  <!-- Contenedor del nombre y perfil -->
  <div class="user-info">
    <span id="nombreUsuario"></span>
    <div class="profile-icon" id="profileIcon">üë§</div>
  </div>
</header>

<main>
  <h2><span id="nombreUsuario"></span></h2>
  <h1>Guardados</h1>
  <div class="historial-container" id="guardadosContainer"></div>
</main>
</div>

<!-- MEN√öS -->
<div class="menu-lateral" id="menuLateral">
  <button onclick="location.href='Segundo avance_Ver historial.html'">Historial</button>
  <button onclick="location.href='Segundo avance_Ver guardados.html'">Guardados</button>
  <button onclick="location.href='Segundo avance_Ver me gustas.html'">Me gusta</button>
</div>

<div class="menu-lateral menu-derecha" id="menuPerfil">
  <button onclick="location.href='Cuenta.html'">Cuenta</button>
  <button onclick="location.href='Segundo avance_Usuario.html'">Ver mi foro</button>

  <!-- Botones que se ocultar√°n si NO eres admin -->
  <button id="btnSolicitudes" onclick="location.href='Segundo avance_Solicitudes.html'">Solicitudes</button>
  <button id="btnBaneados" onclick="location.href='Segundo avance_Baneados.html'">Baneados</button>
  <button id="btnDadasBaja" onclick="location.href='Segundo Avance_Publicaciones baneadas.html'">Dadas de baja</button>

  <button id="toggleAspecto">Aspecto: Cla/Osc</button>
  <button onclick="location.href='BrazukaR.html'">Salir</button>
</div>


<script>


// FOTO DE PERFIL SEG√öN EL ROL

const rol = localStorage.getItem("rolUsuario");

const fotoUsuario = document.getElementById("fotoUsuario");

const fotos = {
  admin: "https://static.vecteezy.com/system/resources/previews/014/541/527/original/administrator-system-icon-simple-style-vector.jpg",
  usuario: "https://i0.wp.com/icon-library.com/images/user-icon-png-transparent/user-icon-png-transparent-17.jpg",
  invitado: "https://static.vecteezy.com/system/resources/previews/008/302/462/large_2x/eps10-grey-user-icon-or-logo-in-simple-flat-trendy-modern-style-isolated-on-white-background-free-vector.jpg"
};


// --- √çCONO DE LA ESQUINA ---
if (rol === "admin") {
  profileIcon.textContent = ""; 
  profileIcon.style.backgroundImage = `url('${fotos.admin}')`;
}
else if (rol === "usuario") {
  profileIcon.textContent = "";
  profileIcon.style.backgroundImage = `url('${fotos.usuario}')`;
}
else if (rol === "invitado") {
  profileIcon.textContent = "";
  profileIcon.style.backgroundImage = `url('${fotos.invitado}')`;
}

profileIcon.style.backgroundSize = "cover";
profileIcon.style.backgroundPosition = "center";

// Ocultar botones seg√∫n el rol
if (rol !== "admin") {
  document.getElementById("btnSolicitudes").style.display = "none";
  document.getElementById("btnBaneados").style.display = "none";
  document.getElementById("btnDadasBaja").style.display = "none";
}

function cargarGuardados() {
  const cont = document.getElementById('guardadosContainer');
  cont.innerHTML = '';

  const guardados = [];

// Cargar todos los posts guardados (videos, im√°genes, mundiales y estadios)
for (let key in localStorage) {
  if (key.startsWith('post_video_') || key.startsWith('post_imagen_') || key.startsWith('post_mundial_') || key.startsWith('post_jugador_') || key.startsWith('post_estadio_') || key.startsWith('post_guardado_')) {
    try {
      const post = JSON.parse(localStorage.getItem(key));
      if (post) guardados.push(post);
    } catch (e) {}
  }
}

  if (guardados.length === 0) {
    cont.innerHTML = '<p>No tienes publicaciones guardadas.</p>';
    return;
  }

  guardados.sort((a, b) => b.timestamp - a.timestamp); // m√°s reciente primero

  guardados.forEach(post => {
    const div = document.createElement('div');
    div.className = 'post-item';

    let thumbHTML = '';

    if (post.tipo === 'video') {
      // Siempre mostrar un video o imagen como miniatura
      if (post.thumbnail) {
        // Miniatura como imagen (Historial y consistencia)
        thumbHTML = `
          <img src="${post.thumbnail}" alt="${post.titulo}">
          <div class="play-icon"><i class="fa-solid fa-play"></i></div>
        `;
      } else if (post.videoSrc) {
        // Si no hay thumbnail, usar el video con poster vac√≠o
        thumbHTML = `
          <video src="${post.videoSrc}" muted preload="metadata" poster></video>
          <div class="play-icon"><i class="fa-solid fa-play"></i></div>
        `;
      } else {
        thumbHTML = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#999;">No hay miniatura</div>`;
      }
    } else {
      // Para imagen o mundial
      if (post.thumbnail) {
        thumbHTML = `<img src="${post.thumbnail}" alt="${post.titulo}">`;
      } else {
        thumbHTML = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#999;">No hay imagen</div>`;
      }
    }

    div.innerHTML = `
      <div class="thumbnail">${thumbHTML}</div>
      <div class="post-info">
        <h2>${post.titulo}</h2>
        <p>${post.autor}</p>
      </div>
    `;

    div.querySelector('.thumbnail').onclick = () => window.location.href = post.url;
    div.querySelector('h2').onclick = () => window.location.href = post.url;

    cont.appendChild(div);
  });
}


cargarGuardados();

// ====== Men√∫s laterales ======
const menuLateral=document.getElementById('menuLateral');
const menuPerfil=document.getElementById('menuPerfil');
const pageContent=document.getElementById('pageContent');

document.querySelector('.menu-icon').onclick = e=>{
  e.stopPropagation();
  menuLateral.classList.toggle('abierto');
  menuPerfil.classList.remove('abierto');
  pageContent.style.transform = menuLateral.classList.contains('abierto')?"translateX(180px)":"translateX(0)";
};

document.querySelector('.profile-icon').onclick = e=>{
  e.stopPropagation();
  menuPerfil.classList.toggle('abierto');
  menuLateral.classList.remove('abierto');
  pageContent.style.transform = menuPerfil.classList.contains('abierto')?"translateX(-180px)":"translateX(0)";
};

document.addEventListener('click', e=>{
  if(!menuLateral.contains(e.target)&&!menuPerfil.contains(e.target)){
    menuLateral.classList.remove('abierto');
    menuPerfil.classList.remove('abierto');
    pageContent.style.transform="translateX(0)";
  }
});

// ====== Logo ======
document.querySelector('.logo').onclick = ()=>location.href='Segundo avance_Pagina Principal.html';

// ====== Modo claro/oscuro ======
(function(){
  const btn = document.getElementById('toggleAspecto'); 
  let modo = localStorage.getItem('modoBrazuk') || 'claro';

  aplicarModo(modo);

  btn.onclick = ()=>{
    modo = (modo === 'claro') ? 'oscuro' : 'claro';
    localStorage.setItem('modoBrazuk', modo);
    aplicarModo(modo);
  };

function aplicarModo(m){
  const titulo = document.querySelector("h1");
  const logo = document.querySelector(".logo");
  const menuIcon = document.querySelector(".menu-icon");
  const nombreUsuarioSpan = document.getElementById('nombreUsuario');

  if(m === "oscuro"){
    document.body.style.background = "#111";
    document.querySelector("header").style.background = "#000";

    titulo.style.color = "#fff";
    logo.style.color = "#fff";
    menuIcon.style.color = "#fff";
    nombreUsuarioSpan.style.color = '#fff'; 
  } else {
    document.body.style.background = "#fff";
    document.querySelector("header").style.background = "#f4c52b";

    titulo.style.color = "#000";
    logo.style.color = "#000";
    menuIcon.style.color = "#000";
    nombreUsuarioSpan.style.color = '#000'; 
  }
}

})();

const nombre = localStorage.getItem("nombreUsuario") || "Invitado";
document.getElementById("nombreUsuario").textContent = `${nombre}`;

</script>

<div id="avisoLogo" class="aviso-logo">
  <span>Aqui puedes ver los post que has guardado, pulsa alguno para ir a verlo</span>
  <button class="cerrar-aviso">√ó</button>
</div>
<script>
  document.querySelector(".cerrar-aviso").addEventListener("click", function () {
    document.getElementById("avisoLogo").style.display = "none";
  });
</script>

</body>
</html>
